<Row>:
  size_hint_y: None
  height: label.texture_size[1]
  Label:
    id: label
    text: root.lable_text
    font_size: root.fs
    text_size: self.width, None
    size_hint: (1, None)
    size: self.parent.width, self.texture_size[1]
    max_lines:1
    shorten: True
    shorten_from: 'left'
    color: 1, 1, 1, .5
    halign: 'right'
    valign: 'center'

RootWidget:
  canvas.before:
    Color:
      rgba: .1,.1,.13, 1
    Rectangle:
      pos: self.pos
      size: self.size
  orientation: 'vertical'
  story:story
  entry: entry
  BoxLayout:
    orientation: 'vertical'
    size_hint: 1, 0.3
    padding: [self.width//50,self.height//50]
    spacing: self.height//10
    ScrollView:
      scroll_y: 0
      scroll_x: 1
      BoxLayout:
        id: story
        size_hint_y: None
        height: self.minimum_height
        orientation: "vertical"

    Label:
      id: entry
      text: '0'
      size_hint_y: 0.3
      text_size: self.width, self.height
      font_size: self.height
      max_lines:1
      shorten: True
      shorten_from: 'left'
      halign: 'right'
      valign: 'bottom'


  GridLayout:
    canvas.before:
      Color:
        rgba: .15,.15,.17, 1
      Rectangle:
        pos: self.pos
        size: self.size
    cols: 5
    size_hint: 1, 0.7
    padding: 3
    spacing: 3
    Button:
      text: '^'
      on_press: root.add_operation(self)
    Button:
      text: 'mod'
      on_press: root.add_operation(self)
    CustomButton:
      functions: ['φ(x)','F(N)']
      on_long_press: root.switch_key(self)
      on_press: root.add_number(self)
    Button:
      text: 'x-¹'
      on_press: root.add_operation(self)
    Button:
      text: '<-'
      on_press: root.delete(self)

    Button:
      text: '×'
      on_press: root.add_operation(self)
    Button:
      text: '7'
      on_press: root.add_number(self)
    Button:
      text: '8'
      on_press: root.add_number(self)
    Button:
      text: '9'
      on_press: root.add_number(self)
    Button:
      text: 'C'
      on_press: root.clean(self)

    Button:
      text: '÷'
      on_press: root.add_operation(self)
    Button:
      text: '4'
      on_press: root.add_number(self)
    Button:
      text: '5'
      on_press: root.add_number(self)
    Button:
      text: '6'
      on_press: root.add_number(self)
    CustomButton:
      functions: ['НОД','НОК']
      on_long_press: root.switch_key(self)
      on_press: root.add_number(self)

    Button:
      text: '+'
      on_press: root.add_operation(self)
    Button:
      text: '1'
      on_press: root.add_number(self)
    Button:
      text: '2'
      on_press: root.add_number(self)
    Button:
      text: '3'
      on_press: root.add_number(self)
    Button:
      text: '( )'
      on_press: root.add_parentheses(self)

    Button:
      text: '-'
      on_press: root.add_operation(self)
    Button:
      text: ','
      on_press: root.add_operation(self)
    Button:
      text: '0'
      on_press: root.add_number(self)
    Button:
      text: '.'
      on_press: root.add_number(self)
    Button:
      text: '='
      background_down: ''
      background_color: 1, 0.2, 0.1, .9
      on_press: root.result(self)

<CustomButton>:
  text: self.functions[self.cur_func]
  long_press_time: 0.5
  canvas.before:
    Color:
      rgba: root.funcs_colors[root.cur_func]
    Rectangle:
      pos: self.pos
      size: (self.size[0],self.size[1]//10)

<Button>:
  shorten: False
  background_normal: ''
  background_color: 1, 1, 1, .05
  text_size: self.width, self.height
  font_size: self.height//3
  halign: 'center'
  valign: 'center'
